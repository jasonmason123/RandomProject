import{r as x,q as G,E as M,j as e,L as u,F as q,B as d}from"./index-DdHUMgm0.js";import{u as B,c as P,a as N,b as T,I as o,F as c}from"./InputGroup-CeoBAgZk.js";import{B as p}from"./common-DOkR66UH.js";import{a as y}from"./authentication-api-caller-TsD-gHrN.js";import{u as V}from"./useTranslation-CF2MTt9i.js";import"./index-NQ4ToruW.js";const z=()=>{const[b,j]=x.useState(!1),[f,m]=x.useState(!1),[h,w]=x.useState(!1),k=G(),[i]=V(),C=async(a,l,E)=>{try{j(!0),await y.signIn({email:a,password:l},E).then(async t=>{var g=await t.json();if(t.ok)g.isEmailConfirmed==!1?k(`/verify-account/${g.confirmationToken}`):window.location.href="/";else{const S=g.isLockedOut==!0?"You have entered the wrong password too many times. Please try again in 5 minutes.":"Email or password is incorrect. Please try again.";d.error(S)}})}catch(t){console.error("Sign in error: ",t),d.error("An exception had occurred. Please try again later.")}finally{j(!1)}},F=async a=>{try{m(!0),await y.signInWithGoogle(a),m(!1)}catch(l){m(!1),d.error(l.message||"Failed")}},I=async()=>{try{throw w(!0),new Error("Not implemented")}catch(a){w(!1),d.error(a.message||"Failed")}},{handleChange:v,values:n,handleSubmit:L,touched:r,errors:s,setFieldValue:A,submitForm:R}=B({initialValues:{email:"",password:"",isRemembered:!1},validationSchema:P({email:N().email("Invalid email address").required("Required"),password:N().min(6,"Must be 6 characters or more").max(30,"Must be 30 characters or less").required("Required"),isRemembered:T()}),onSubmit:a=>{C(a.email,a.password,a.isRemembered)}});return M("hold-transition login-page"),e.jsx("div",{className:"login-box",children:e.jsxs("div",{className:"card card-outline card-primary",children:[e.jsx("div",{className:"card-header text-center",children:e.jsx(u,{to:"/",className:"h1",children:e.jsx("b",{children:"CodLUCK"})})}),e.jsxs("div",{className:"card-body",children:[e.jsx("p",{className:"login-box-msg",children:i("login.label.signIn")}),e.jsxs("form",{onSubmit:L,children:[e.jsx("div",{className:"mb-3",children:e.jsxs(o,{className:"mb-3",children:[e.jsx(c.Control,{id:"email",name:"email",type:"email",placeholder:"Email",onChange:v,value:n.email,isValid:r.email&&!s.email,isInvalid:r.email&&!!s.email}),r.email&&s.email?e.jsx(c.Control.Feedback,{type:"invalid",children:s.email}):e.jsx(o.Append,{children:e.jsx(o.Text,{children:e.jsx("i",{className:"fas fa-envelope"})})})]})}),e.jsx("div",{className:"mb-3",children:e.jsxs(o,{className:"mb-3",children:[e.jsx(c.Control,{id:"password",name:"password",type:"password",placeholder:"Password",onChange:v,value:n.password,isValid:r.password&&!s.password,isInvalid:r.password&&!!s.password}),r.password&&s.password?e.jsx(c.Control.Feedback,{type:"invalid",children:s.password}):e.jsx(o.Append,{children:e.jsx(o.Text,{children:e.jsx("i",{className:"fas fa-lock"})})})]})}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-8",children:e.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[e.jsx(q,{id:"rememberMe",checked:n.isRemembered,onChange:a=>{const l=a.target;A("isRemembered",l.checked)}}),e.jsx("label",{style:{margin:0,padding:0,paddingLeft:"4px"},htmlFor:"rememberMe",children:i("login.label.rememberMe")})]})}),e.jsx("div",{className:"col-4",children:e.jsx(p,{loading:b,disabled:h||f,onClick:R,children:i("login.button.signIn.label")})})]})]}),e.jsxs("div",{className:"social-auth-links text-center mt-2 mb-3",children:[e.jsxs(p,{className:"mb-2",onClick:I,loading:h,disabled:!0,children:[e.jsx("i",{className:"fab fa-facebook mr-2"}),i("login.button.signIn.social",{what:"Facebook"})]}),e.jsxs(p,{variant:"danger",onClick:()=>F(n.isRemembered),loading:f,disabled:b||h,children:[e.jsx("i",{className:"fab fa-google mr-2"}),i("login.button.signIn.social",{what:"Google"})]})]}),e.jsx("p",{className:"mb-1",children:e.jsx(u,{to:"/forgot-password",children:i("login.label.forgotPass")})}),e.jsx("p",{className:"mb-0",children:e.jsx(u,{to:"/register",className:"text-center",children:i("login.label.registerNew")})})]})]})})};export{z as default};
