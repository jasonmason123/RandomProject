import{r as x,u as L,E as S,F as G,G as u,P,Q as q,J as E,j as e,L as g,K as t,M as B,B as d}from"./index-B9nS6S8q.js";import{B as j}from"./common-CgraHF7X.js";import{a as v}from"./authentication-api-caller-TsD-gHrN.js";import{u as M}from"./useTranslation-DvKfDV_k.js";import{I as i}from"./InputGroup-OJcgSMOE.js";const K=()=>{const[w,b]=x.useState(!1),[y,c]=x.useState(!1),[m,f]=x.useState(!1),[o]=M(),N=L(),k=async(a,I)=>{try{b(!0),await v.signUp({email:a,password:I},!0).then(async l=>{if(l.ok){const n=await l.text();N(`/verify-account/${n}`)}else l.text().then(n=>{console.error("Sign up api error: ",n),d.error(n||"Register unsuccessful. Please try again.")})})}catch(l){console.error("Sign up error: ",l),d.error("An exception had occurred. Please try again later.")}finally{b(!1)}},R=async()=>{try{c(!0),await v.signInWithGoogle(!0),c(!1)}catch(a){d.error(a.message||"Failed"),c(!1)}},C=async()=>{try{throw f(!0),new Error("Not implemented")}catch(a){f(!1),d.error(a.message||"Failed")}},{handleChange:p,values:h,handleSubmit:F,touched:r,errors:s,submitForm:A}=S({initialValues:{email:"",password:"",passwordRetype:""},validationSchema:G({email:u().email("Invalid email address").required("Required"),password:u().min(8,"Must be 8 characters or more").max(30,"Must be 30 characters or less").test("is-strong-password",'Password must have at least 1 uppercase letter, 1 lowercase letter, 1 number, and 1 special character (! @ # $ % ^ & * ( ) , . ? " : { } | < >)',a=>a?P(a):!1).required("Required"),passwordRetype:u().min(8,"Must be 8 characters or more").max(30,"Must be 30 characters or less").oneOf([q("password")],"Passwords must match").required("Required")}),onSubmit:a=>{k(a.email,a.password)}});return E("hold-transition register-page"),e.jsx("div",{className:"register-box",children:e.jsxs("div",{className:"card card-outline card-primary",children:[e.jsx("div",{className:"card-header text-center",children:e.jsx(g,{to:"/",className:"h1",children:e.jsx("b",{children:"CodLUCK"})})}),e.jsxs("div",{className:"card-body",children:[e.jsx("p",{className:"login-box-msg",children:o("register.registerNew")}),e.jsxs("form",{onSubmit:F,children:[e.jsx("div",{className:"mb-3",children:e.jsxs(i,{className:"mb-3",children:[e.jsx(t.Control,{id:"email",name:"email",type:"email",placeholder:"Email",onChange:p,value:h.email,isValid:r.email&&!s.email,isInvalid:r.email&&!!s.email}),r.email&&s.email?e.jsx(t.Control.Feedback,{type:"invalid",children:s.email}):e.jsx(i.Append,{children:e.jsx(i.Text,{children:e.jsx("i",{className:"fas fa-envelope"})})})]})}),e.jsx("div",{className:"mb-3",children:e.jsxs(i,{className:"mb-3",children:[e.jsx(t.Control,{id:"password",name:"password",type:"password",placeholder:"Password",onChange:p,value:h.password,isValid:r.password&&!s.password,isInvalid:r.password&&!!s.password}),r.password&&s.password?e.jsx(t.Control.Feedback,{type:"invalid",children:s.password}):e.jsx(i.Append,{children:e.jsx(i.Text,{children:e.jsx("i",{className:"fas fa-lock"})})})]})}),e.jsx("div",{className:"mb-3",children:e.jsxs(i,{className:"mb-3",children:[e.jsx(t.Control,{id:"passwordRetype",name:"passwordRetype",type:"password",placeholder:"Retype password",onChange:p,value:h.passwordRetype,isValid:r.passwordRetype&&!s.passwordRetype,isInvalid:r.passwordRetype&&!!s.passwordRetype}),r.passwordRetype&&s.passwordRetype?e.jsx(t.Control.Feedback,{type:"invalid",children:s.passwordRetype}):e.jsx(i.Append,{children:e.jsx(i.Text,{children:e.jsx("i",{className:"fas fa-lock"})})})]})}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-7",children:e.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[e.jsx(B,{id:"terms",checked:!1}),e.jsxs("label",{style:{margin:0,padding:0,paddingLeft:"4px"},htmlFor:"terms",children:[e.jsx("span",{children:"I agree to the "}),e.jsx(g,{to:"/",children:"terms"})," "]})]})}),e.jsx("div",{className:"col-5",children:e.jsx(j,{onClick:A,loading:w,disabled:y||m,children:o("register.label")})})]})]}),e.jsxs("div",{className:"social-auth-links text-center",children:[e.jsxs(j,{className:"mb-2",onClick:C,loading:m,disabled:!0,children:[e.jsx("i",{className:"fab fa-facebook mr-2"}),o("login.button.signIn.social",{what:"Facebook"})]}),e.jsxs(j,{variant:"danger",onClick:R,loading:y,disabled:w||m,children:[e.jsx("i",{className:"fab fa-google mr-2"}),o("login.button.signUp.social",{what:"Google"})]})]}),e.jsx(g,{to:"/login",className:"text-center",children:o("register.alreadyHave")})]})]})})};export{K as default};
