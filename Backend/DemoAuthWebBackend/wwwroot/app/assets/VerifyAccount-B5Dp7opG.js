import{q as A,J as R,r as m,j as e,L as u,B as n}from"./index-DdHUMgm0.js";import{a as f}from"./authentication-api-caller-TsD-gHrN.js";import{B as V}from"./common-DOkR66UH.js";import{u as I,c as P,a as S,I as d,F as x}from"./InputGroup-CeoBAgZk.js";import{u as E}from"./useTranslation-CF2MTt9i.js";import"./index-NQ4ToruW.js";const M=()=>{const v=A(),{c:l}=R(),[j,h]=m.useState(!1),[o,s]=m.useState(!1),[y]=E(),g=async i=>{try{s(!0),h(!0),await f.resendCode(i).then(async a=>{if(a.ok){const r=await a.json();v(`/verify-account/${r.key}`,{replace:!0})}else{const r=await a.json();console.error("Verification failed:",r),n.error("An error occurred while resending the verification code. Please try again later.")}})}catch(a){console.error("Error during verification:",a),n.error("An error occurred while resending the verification code. Please try again later.")}finally{h(!1),s(!1)}},p=async(i,a)=>{try{s(!0),await f.verifyAccount(i,a).then(async r=>{if(r.ok)window.location.href="/";else{const k=await r.text();console.error("Verification failed:",k),n.error("Invalid verification code. Please try again.")}})}catch(r){console.error("Error during verification:",r),n.error("An error occurred during verification. Please try again later.")}finally{s(!1)}},{handleChange:b,values:N,handleSubmit:w,touched:c,errors:t,submitForm:C}=I({initialValues:{code:""},validationSchema:P({code:S().min(6,"Must be 6 characters").max(6,"Must be 6 characters").required("Required")}),onSubmit:async i=>{await p(l,i.code)}});return e.jsx("div",{className:"register-box",children:e.jsxs("div",{className:"card card-outline card-primary",children:[e.jsx("div",{className:"card-header text-center",children:e.jsx(u,{to:"/",className:"h1",children:e.jsx("b",{children:"CodLUCK"})})}),e.jsxs("div",{className:"card-body",children:[e.jsx("p",{className:"login-box-msg",children:"Please enter the verification code sent to your email."}),e.jsxs("form",{onSubmit:w,children:[e.jsx("div",{className:"mb-3",children:e.jsxs(d,{className:"mb-3",children:[e.jsx(x.Control,{id:"code",name:"code",type:"text",placeholder:"Verification Code",onChange:b,value:N.code,isValid:c.code&&!t.code,isInvalid:c.code&&!!t.code}),c.code&&t.code?e.jsx(x.Control.Feedback,{type:"invalid",children:t.code}):e.jsx(d.Append,{children:e.jsx(d.Text,{children:e.jsx("i",{className:"fas fa-envelope"})})})]})}),e.jsx("div",{className:"row",children:e.jsx("div",{className:"col-12",children:e.jsx(V,{onClick:C,loading:o,disabled:o,children:"Verify"})})})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx(u,{to:"/register",className:"text-center",children:y("verify.backToRegister")}),e.jsx("div",{className:"text-center mt-2",children:e.jsx("button",{type:"button",className:"btn btn-link p-0",onClick:()=>g(l),disabled:o,children:j?"Resending...":"Resend Code"})})]})]})]})})};export{M as default};
