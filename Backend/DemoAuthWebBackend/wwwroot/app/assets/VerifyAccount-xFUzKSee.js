import{u as A,T as R,r as u,E as V,F as E,G as I,j as e,L as m,K as f,B as n}from"./index-B9nS6S8q.js";import{a as x}from"./authentication-api-caller-TsD-gHrN.js";import{B as P}from"./common-CgraHF7X.js";import{u as S}from"./useTranslation-DvKfDV_k.js";import{I as d}from"./InputGroup-OJcgSMOE.js";const q=()=>{const v=A(),{c:l}=R(),[j,h]=u.useState(!1),[o,s]=u.useState(!1),[y]=S(),g=async i=>{try{s(!0),h(!0),await x.resendCode(i).then(async a=>{if(a.ok){const r=await a.json();v(`/verify-account/${r.key}`,{replace:!0})}else{const r=await a.json();console.error("Verification failed:",r),n.error("An error occurred while resending the verification code. Please try again later.")}})}catch(a){console.error("Error during verification:",a),n.error("An error occurred while resending the verification code. Please try again later.")}finally{h(!1),s(!1)}},p=async(i,a)=>{try{s(!0),await x.verifyAccount(i,a).then(async r=>{if(r.ok)window.location.href="/";else{const k=await r.text();console.error("Verification failed:",k),n.error("Invalid verification code. Please try again.")}})}catch(r){console.error("Error during verification:",r),n.error("An error occurred during verification. Please try again later.")}finally{s(!1)}},{handleChange:b,values:N,handleSubmit:w,touched:c,errors:t,submitForm:C}=V({initialValues:{code:""},validationSchema:E({code:I().min(6,"Must be 6 characters").max(6,"Must be 6 characters").required("Required")}),onSubmit:async i=>{await p(l,i.code)}});return e.jsx("div",{className:"register-box",children:e.jsxs("div",{className:"card card-outline card-primary",children:[e.jsx("div",{className:"card-header text-center",children:e.jsx(m,{to:"/",className:"h1",children:e.jsx("b",{children:"CodLUCK"})})}),e.jsxs("div",{className:"card-body",children:[e.jsx("p",{className:"login-box-msg",children:"Please enter the verification code sent to your email."}),e.jsxs("form",{onSubmit:w,children:[e.jsx("div",{className:"mb-3",children:e.jsxs(d,{className:"mb-3",children:[e.jsx(f.Control,{id:"code",name:"code",type:"text",placeholder:"Verification Code",onChange:b,value:N.code,isValid:c.code&&!t.code,isInvalid:c.code&&!!t.code}),c.code&&t.code?e.jsx(f.Control.Feedback,{type:"invalid",children:t.code}):e.jsx(d.Append,{children:e.jsx(d.Text,{children:e.jsx("i",{className:"fas fa-envelope"})})})]})}),e.jsx("div",{className:"row",children:e.jsx("div",{className:"col-12",children:e.jsx(P,{onClick:C,loading:o,disabled:o,children:"Verify"})})})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx(m,{to:"/register",className:"text-center",children:y("verify.backToRegister")}),e.jsx("div",{className:"text-center mt-2",children:e.jsx("button",{type:"button",className:"btn btn-link p-0",onClick:()=>g(l),disabled:o,children:j?"Resending...":"Resend Code"})})]})]})]})})};export{q as default};
